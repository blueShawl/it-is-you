# Modern Photo Viewer - User Guide

## 概述

Modern Photo Viewer 是一款使用 PyQt5 开发的高性能照片和视频查看软件，专为管理大量照片集合而设计，具有现代、美观的界面。

## 主要特性

### 🚀 性能优化
- **高效扫描**: 快速扫描和索引数千张照片
- **智能缓存**: 缩略图缓存机制，优化性能
- **虚拟滚动**: 处理大量照片而不卡顿
- **异步加载**: 后台加载图片，界面响应迅速

### 🎨 现代界面
- **年轻化设计**: 符合年轻人审美的界面设计
- **深色/浅色主题**: 可切换的主题支持
- **响应式布局**: 自适应窗口大小
- **优雅动画**: 流畅的用户交互体验

### 📂 智能组织
- **时间排序**: 按创建时间自动排序（最新在前）
- **文件夹浏览**: 按目录结构浏览照片
- **元数据提取**: 自动提取 EXIF 信息
- **重复检测**: 智能识别重复照片

### 🔧 便捷功能
- **右键菜单**: 丰富的上下文操作
- **详细信息**: 完整的照片元数据显示
- **快速预览**: 双击快速打开
- **批量选择**: 支持多选操作

## 快速开始

### 1. 安装依赖

```bash
pip install -r requirements.txt
```

必需的包：
- PyQt5 >= 5.15.0
- Pillow >= 8.0.0
- python-dateutil >= 2.8.0
- watchdog >= 2.1.0

### 2. 运行应用

```bash
python main.py
```

### 3. 首次设置

1. 应用启动后会显示欢迎对话框
2. 选择包含照片的主文件夹
3. 配置扫描选项
4. 点击"继续"开始扫描

## 界面说明

### 主窗口

**标签页**:
- **All Photos**: 显示所有照片，按时间排序
- **Browse Folders**: 按文件夹结构浏览照片

**工具栏**:
- `Scan Photos`: 重新扫描照片
- `Settings`: 打开设置窗口
- `Toggle Theme`: 切换深色/浅色主题

**状态栏**:
- 显示当前操作状态
- 照片数量统计
- 进度条（扫描时）

### 照片画廊

**功能**:
- **左键点击**: 选择/取消选择照片
- **右键点击**: 显示上下文菜单
- **双击**: 用默认程序打开照片
- **滚动**: 虚拟滚动，支持大量照片

**上下文菜单**:
- `View Details...`: 查看详细信息
- `Open with Default Viewer`: 用默认程序打开
- `Show in Explorer`: 在文件管理器中显示
- `Copy File Path`: 复制文件路径
- `Copy File Name`: 复制文件名
- `Delete File...`: 删除文件

### 文件夹浏览

**左侧面板**:
- 文件夹树形视图
- 显示每个文件夹的照片数量
- 点击文件夹查看其中的照片

**右侧面板**:
- 显示所选文件夹中的照片
- 与主画廊功能相同

### 设置窗口

#### 常规设置
- **Photo Directory**: 设置照片主目录
- **Automatically scan**: 启动时自动扫描
- **Include hidden files**: 包含隐藏文件和文件夹

#### 外观设置
- **Color Theme**: 选择深色或浅色主题
- **Thumbnail Size**: 调整缩略图大小 (100-400px)

#### 性能设置
- **Enable thumbnail caching**: 启用缩略图缓存
- **Max Cache Size**: 最大缓存大小 (100-2000 MB)
- **Clear Cache**: 清除缓存
- **Cache Info**: 查看缓存信息

## 支持的文件格式

### 图片格式
- JPEG (.jpg, .jpeg)
- PNG (.png)
- GIF (.gif)
- BMP (.bmp)
- TIFF (.tiff, .tif)
- WebP (.webp)
- ICO (.ico)
- SVG (.svg)

### 视频格式
- MP4 (.mp4)
- AVI (.avi)
- MOV (.mov)
- MKV (.mkv)
- WMV (.wmv)
- FLV (.flv)
- WebM (.webm)
- M4V (.m4v)
- 3GP (.3gp)
- OGV (.ogv)

## 高级功能

### 照片详情

点击右键菜单中的"View Details..."可查看：

**基本信息**:
- 文件名、格式、大小
- 图片尺寸
- 创建和修改时间
- 所在文件夹

**元数据 (EXIF)**:
- 相机信息
- 拍摄参数
- GPS 位置（如有）
- 其他 EXIF 数据

**文件信息**:
- 完整路径
- 文件哈希值
- 权限信息
- 系统属性

### 性能优化

**虚拟滚动**:
- 只渲染可见区域的缩略图
- 支持数万张照片的流畅浏览
- 智能预加载和清理

**缓存机制**:
- 自动生成和缓存缩略图
- 支持大小调整
- 智能缓存清理

**异步处理**:
- 后台扫描照片
- 异步生成缩略图
- 非阻塞用户界面

## 键盘快捷键

- `Ctrl+R`: 重新扫描照片
- `Ctrl+,`: 打开设置
- `F5`: 刷新当前视图
- `Ctrl+Q`: 退出应用程序

## 故障排除

### 常见问题

**Q: 应用启动很慢？**
A: 检查照片目录是否包含大量文件，考虑减少扫描范围或启用缓存。

**Q: 缩略图不显示？**
A: 确认文件格式支持，检查文件是否损坏，尝试清除缓存重新生成。

**Q: 扫描进度卡住？**
A: 可能遇到损坏的文件，检查控制台错误信息，考虑跳过问题文件。

**Q: 内存占用过高？**
A: 减少缩略图大小，限制缓存大小，重启应用程序。

### 性能建议

1. **存储优化**:
   - 使用 SSD 存储照片获得更好性能
   - 保持文件夹组织良好
   - 定期清理重复和不需要的照片

2. **设置优化**:
   - 根据设备性能调整缩略图大小
   - 合理设置缓存大小
   - 关闭不必要的扫描选项

3. **使用建议**:
   - 定期重新扫描以更新索引
   - 使用文件夹浏览功能快速定位
   - 善用右键菜单功能

## 系统要求

- **操作系统**: Windows 7/10/11, macOS 10.12+, Linux
- **Python**: 3.7 或更高版本
- **内存**: 建议 4GB 以上
- **存储**: 100MB 应用程序 + 缓存空间
- **显示**: 建议 1920x1080 或更高分辨率

## 技术架构

### 核心组件

- **PhotoScanner**: 高性能照片扫描器
- **PhotoDatabase**: 内存照片数据库
- **ThumbnailGenerator**: 智能缩略图生成器
- **VirtualScrollGallery**: 虚拟滚动画廊
- **Config**: 配置管理系统

### 设计模式

- **MVC 架构**: 清晰的模型-视图-控制器分离
- **信号-槽机制**: PyQt5 事件驱动编程
- **工厂模式**: 组件创建和管理
- **观察者模式**: 状态更新和通知

## 开发说明

### 项目结构

```
modern-photo-viewer/
├── main.py                 # 应用程序入口
├── requirements.txt        # 依赖包列表
├── README.md              # 项目说明
├── create_sample_photos.py # 示例照片生成器
└── src/                   # 源代码目录
    ├── __init__.py
    ├── config.py          # 配置管理
    ├── styles.py          # UI 样式
    ├── main_window.py     # 主窗口
    ├── settings_window.py # 设置窗口
    ├── photo_scanner.py   # 照片扫描器
    ├── photo_gallery.py   # 照片画廊
    ├── folder_browser.py  # 文件夹浏览器
    ├── photo_details.py   # 照片详情
    ├── thumbnail_generator.py # 缩略图生成器
    └── video_player.py    # 视频播放器
```

### 扩展开发

如需添加新功能：

1. 在相应模块中添加功能代码
2. 更新信号和槽连接
3. 添加 UI 元素和样式
4. 更新配置选项（如需要）
5. 测试功能和性能

## 许可证

本项目采用 MIT 许可证，详见 LICENSE 文件。

---

*享受使用 Modern Photo Viewer 管理您的照片收藏！*